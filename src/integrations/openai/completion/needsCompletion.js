"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.needsCompletion = needsCompletion;
const debug_1 = __importDefault(require("debug"));
const debug = (0, debug_1.default)('app:needsCompletion');
/**
 * Determines whether a response needs further completion based on certain conditions.
 * @param maxTokensReached - Boolean indicating if the max token limit was reached in the response.
 * @param finishReason - The reason the OpenAI API stopped generating content.
 * @param content - The current content generated by the OpenAI API.
 * @returns Boolean indicating if the response requires further completion.
 */
function needsCompletion(maxTokensReached, finishReason, content) {
    const endsInPunctuation = /[.!?]$/.test(content.trim());
    const needsMore = maxTokensReached && finishReason !== 'stop' && !endsInPunctuation;
    debug('Needs Completion Check:', { maxTokensReached, finishReason, content, needsMore });
    return needsMore;
}
